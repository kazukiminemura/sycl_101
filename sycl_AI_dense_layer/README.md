# サンプルコード：SYCLを使った簡単なAI推論（1層のDense Layer）
シンプルなニューラルネットワークの推論部分をSYCLで実装する例を示します。この例では、SYCLの行列演算を使って、簡単な1層のニューラルネットワーク（Dense Layer）で推論を行います。

## 概要
入力データと重み行列を使って、1層のDense Layer（全結合層）の推論を行います。SYCLのparallel_forを使って並列計算を実装しています。

## コードの説明
### ネットワークの構造: 
この例では、1層の全結合層（Dense Layer）を実装しています。入力は4次元のベクトルで、3つの出力ニューロンがあります。各ニューロンには重みベクトルとバイアスがあります。    

```
   Input        Weights      Bias         Output
  -------      ---------    -------      ---------
   [X0] -------- W0,0 -----> [O0] --+--> Output 0
   [X1] -------- W0,1 -----> [O0] --|   
   [X2] -------- W0,2 -----> [O0] --|   
   [X3] -------- W0,3 -----> [O0] --|   
                                +--- Bias 0

   [X0] -------- W1,0 -----> [O1] --+--> Output 1
   [X1] -------- W1,1 -----> [O1] --|   
   [X2] -------- W1,2 -----> [O1] --|   
   [X3] -------- W1,3 -----> [O1] --|   
                                +--- Bias 1

   [X0] -------- W2,0 -----> [O2] --+--> Output 2
   [X1] -------- W2,1 -----> [O2] --|   
   [X2] -------- W2,2 -----> [O2] --|   
   [X3] -------- W2,3 -----> [O2] --|   
                                +--- Bias 2
```

### データの定義:   
input_data：入力データ（4次元ベクトル）。   
weights_data：3つのニューロンに対する重み行列。各ニューロンの重みベクトルは4次元です。  
bias_data：各ニューロンに対するバイアス。   
### SYCLカーネルの実行: 
parallel_forを使用して、各ニューロンの出力を並列に計算しています。各ニューロンは、入力ベクトルとその重みベクトルの内積を計算し、バイアスを加算します。      
### メモリ管理: 
SYCLのUSM（Unified Shared Memory）を使って、ホストとデバイスが共有するメモリを確保しています。malloc_sharedを使って、ホストとデバイスの両方からアクセス可能なメモリ領域を確保し、freeで解放します。 
### 出力の表示: 
カーネルの実行結果として計算された出力を表示しています。
```
$ ./a.out 
Output: 6.3 0.46 3.69
```